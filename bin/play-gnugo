#!/bin/bash

set -e

if [ -z "$1" ]; then
    SIZE="9"
else
    SIZE=$1
fi

if [ $SIZE == "9" ]; then
    TIME="5m"
elif [ $SIZE == "13" ]; then
    TIME="10m"
elif [ $SIZE == "19" ]; then
    TIME="20m"
else
    echo "Size '$SIZE' isn't supported!"
    exit 1
fi

cargo build --release

GNUGO="gnugo --mode gtp --level 0 --chinese-rules --positional-superko --capture-all-dead --score aftermath --play-out-aftermath"
IOMRASCALAI="cargo run --release"


TWOGTP="gogui-twogtp -black \"$GNUGO\" -white \"$IOMRASCALAI\" -verbose -size $SIZE -time $TIME"


set -x

gogui -computer-both -program "$TWOGTP" -size $SIZE
